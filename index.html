<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>雫.net | MOE!</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@5.2.0/github-markdown-light.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #333;
            --accent: #2ecc71; /* Halo Higan 的标准亮绿 */
            --grey: #95a5a6;
            --bg: #fff;
            --link-border: #333;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: var(--bg);
            color: var(--primary);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        .container {
            max-width: 600px; /* 手机端视觉，宽度收窄 */
            margin: 0 auto;
            padding: 40px 20px 80px;
        }

        /* --- 顶部 Header (复刻图二) --- */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 60px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 1px solid #eee;
        }

        .site-title {
            font-size: 1.3rem;
            font-weight: 800; /* 加粗 */
            letter-spacing: 1px;
            color: #333;
        }

        /* 模拟那个汉堡菜单图标 */
        .menu-icon {
            color: var(--accent);
            font-size: 1.5rem;
            cursor: pointer;
        }

        /* --- 倒计时区域 (复刻图二文案) --- */
        .intro-box {
            margin-bottom: 50px;
            font-size: 0.95rem;
            color: #333;
        }
        .intro-text { margin-bottom: 20px; }
        
        .countdown {
            font-family: monospace; /* 等宽字体更有数字感 */
            margin-top: 10px;
            word-break: break-all;
        }

        /* 社交图标栏 */
        .social-icons {
            margin-top: 25px;
            display: flex;
            gap: 12px;
        }
        .social-icons a {
            color: #555;
            font-size: 1.1rem;
            text-decoration: none;
        }

        /* --- "近期发布" 绿色大标题 (复刻图二) --- */
        .section-header {
            font-size: 1.8rem;
            font-weight: 900;
            color: var(--accent); /* 绿色 */
            margin: 40px 0 30px 0;
            letter-spacing: -1px;
        }

        /* --- 文章列表 (复刻图三) --- */
        .post-list {
            display: flex;
            flex-direction: column;
            gap: 30px; /* 列表间距加大 */
        }

        .post-item {
            display: flex;
            flex-direction: column;
        }

        .post-date {
            font-size: 0.85rem;
            color: var(--grey);
            margin-bottom: 5px; /* 日期在标题上面 */
            font-family: monospace;
        }

        .post-title {
            font-size: 1.05rem;
            color: #333;
            text-decoration: none;
            border-bottom: 1px solid #333; /* 黑色细下划线 */
            padding-bottom: 2px;
            width: fit-content; /* 下划线只跟文字一样长 */
            line-height: 1.5;
            font-weight: 500;
            transition: all 0.2s;
        }
        
        .post-title:hover {
            color: var(--accent);
            border-bottom-color: var(--accent);
        }

        /* --- 页脚 (复刻图三底部) --- */
        footer {
            margin-top: 80px;
            text-align: center;
            font-size: 0.8rem;
            color: var(--grey);
            border-top: 1px solid #f0f0f0;
            padding-top: 30px;
            font-family: monospace;
        }
        
        /* 隐藏/显示控制 */
        .hidden { display: none !important; }
        .markdown-body { margin-top: 20px; }
        .back-btn { margin-bottom: 20px; cursor: pointer; color: var(--accent); font-weight: bold;}
    </style>
</head>
<body>

<div class="container">
    <header>
        <div class="header-left" onclick="app.goHome()">
            <img src="https://github.com/3257085208.png" class="avatar" alt="avatar">
            <div class="site-title">聶.net MOE!</div>
        </div>
        <div class="menu-icon"><i class="fa-solid fa-bars"></i></div>
    </header>

    <div id="home-view">
        <div class="intro-box">
            <div class="intro-text">28年后，你还会想起我吗？</div>
            <div class="countdown">
                距离 <span style="font-weight:bold">2052-02-29</span> 还有 
                <span id="timer" style="font-weight:bold">计算中...</span>
            </div>
            
            <div class="social-icons">
                <a href="mailto:nkx080112@gmail.com"><i class="fa-regular fa-envelope"></i></a>
                <a href="https://github.com/3257085208"><i class="fa-brands fa-github"></i></a>
                <a href="#"><i class="fa-brands fa-telegram"></i></a>
                <a href="https://status.nkx.moe"><i class="fa-solid fa-server"></i></a>
            </div>
        </div>

        <div class="section-header">近期发布</div>

        <div id="posts-container" class="post-list">
            <div style="color:#999; font-size:0.9rem;">正在从 GitHub 获取文章...</div>
        </div>
    </div>

    <div id="article-view" class="hidden">
        <div class="back-btn" onclick="app.goHome()">← 返回列表</div>
        <div id="article-content" class="markdown-body"></div>
    </div>

    <footer>
        <div style="margin-bottom:8px;">Theme is Higan Powered by Nie.net</div>
        <div>&copy; 2026 聶.net MOE!</div>
        <div style="margin-top:8px; color:#f1c40f;">
            <i class="fa-solid fa-star"></i> 小站已稳定运行 <span id="uptime">0</span> 天
        </div>
    </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script>
    const app = {
        init() {
            window.addEventListener('hashchange', () => this.handleRoute());
            this.fetchData();
            this.startTimer();
        },

        // 获取 posts.json
        async fetchData() {
            try {
                // 加个时间戳参数 t=... 避免缓存太死
                const res = await fetch('./posts.json?t=' + Date.now());
                if(!res.ok) throw new Error("API Error");
                const posts = await res.json();
                this.renderList(posts);
            } catch (e) {
                document.getElementById('posts-container').innerHTML = "暂无文章或加载失败";
            }
        },

        // 渲染列表 (严格按照图三的样式)
        renderList(posts) {
            const container = document.getElementById('posts-container');
            container.innerHTML = '';
            
            posts.forEach(post => {
                // 列表项 HTML
                const item = document.createElement('div');
                item.className = 'post-item';
                item.innerHTML = `
                    <div class="post-date">${post.date}</div>
                    <a href="#${post.file}" class="post-title">${post.title}</a>
                `;
                container.appendChild(item);
            });
        },

        // 文章渲染
        async renderPost(file) {
            document.getElementById('home-view').classList.add('hidden');
            document.getElementById('article-view').classList.remove('hidden');
            document.getElementById('article-content').innerHTML = "Loading...";
            
            try {
                const res = await fetch(`./posts/${file}`);
                const text = await res.text();
                document.getElementById('article-content').innerHTML = marked.parse(text);
            } catch (e) {
                document.getElementById('article-content').innerHTML = "文章加载失败";
            }
        },

        handleRoute() {
            const hash = window.location.hash.slice(1);
            if(hash) {
                this.renderPost(hash);
            } else {
                document.getElementById('article-view').classList.add('hidden');
                document.getElementById('home-view').classList.remove('hidden');
            }
        },
        
        goHome() { window.location.hash = ''; },

        // 倒计时和运行时间逻辑
        startTimer() {
            // 2052 倒计时
            const target = new Date("2052-02-29").getTime();
            setInterval(() => {
                const diff = target - Date.now();
                const d = Math.floor(diff / 86400000);
                const h = Math.floor((diff % 86400000) / 3600000);
                const m = Math.floor((diff % 3600000) / 60000);
                const s = Math.floor((diff % 60000) / 1000);
                document.getElementById('timer').innerText = `${d} 天 ${h} 时 ${m} 分 ${s} 秒`;
            }, 1000);

            // 运行时间
            const start = new Date("2025-01-01").getTime();
            const daysRun = Math.floor((Date.now() - start) / 86400000);
            document.getElementById('uptime').innerText = daysRun;
        }
    };
    app.init();
</script>
</body>
</html>
